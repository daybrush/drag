/*
Copyright (c) 2019 Daybrush
name: @daybrush/drag
license: MIT
author: Daybrush
repository: git+https://github.com/daybrush/drag.git
version: 0.10.1
*/
!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(t=t||self).Dragger=i()}(this,function(){"use strict";var u=function(){return(u=Object.assign||function(t){for(var i,n=1,s=arguments.length;n<s;n++)for(var e in i=arguments[n])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t}).apply(this,arguments)};function p(t,i,n,s){var e=d(t),a=d(i),h=d(s);return f(r(s[0],o(e,h)),r(s[0],o(a,h)),n[0])}function h(t){return t.touches?g(t.touches):[e(t)]}function f(t,i,n){var s=t.clientX,e=t.clientY;return{clientX:s,clientY:e,deltaX:s-i.clientX,deltaY:e-i.clientY,distX:s-n.clientX,distY:e-n.clientY}}function l(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function v(t,n,s){return t.map(function(t,i){return f(t,n[i],s[i])})}function g(t){for(var i=Math.min(t.length,2),n=[],s=0;s<i;++s)n.push(e(t[s]));return n}function e(t){return{clientX:t.clientX,clientY:t.clientY}}function d(t){return{clientX:(t[0].clientX+t[1].clientX)/2,clientY:(t[0].clientY+t[1].clientY)/2}}function r(t,i){return{clientX:t.clientX+i.clientX,clientY:t.clientY+i.clientY}}function o(t,i){return{clientX:t.clientX-i.clientX,clientY:t.clientY-i.clientY}}function c(t,i,n,s){t.addEventListener(i,n,s)}function n(t,i,n){t.removeEventListener(i,n)}var s=function(){function t(t,i){var a=this;void 0===i&&(i={}),this.el=t,this.options={},this.flag=!1,this.pinchFlag=!1,this.datas={},this.isDrag=!1,this.isPinch=!1,this.isMouse=!1,this.isTouch=!1,this.prevClients=[],this.startClients=[],this.movement=0,this.startPinchClients=[],this.startDistance=0,this.customDist=[0,0],this.onDragStart=function(t){if(a.flag||!1!==t.cancelable){if(function(t){return t.touches&&2<=t.touches.length}(t)){if(!a.flag&&t.touches.length!==t.changedTouches.length)return;a.pinchFlag||a.onPinchStart(t)}if(!a.flag){var i=a.startClients[0]?a.startClients:h(t);a.customDist=[0,0],a.flag=!0,a.isDrag=!1,a.startClients=i,a.prevClients=i,a.datas={};var n=f(i[a.movement=0],a.prevClients[0],a.startClients[0]),s=a.options,e=s.dragstart;(s.preventRightClick&&3===t.which||!1===(e&&e(u({datas:a.datas,inputEvent:t},n))))&&(a.startClients=[],a.prevClients=[],a.flag=!1),a.flag&&t.preventDefault()}}},this.onDrag=function(t){if(a.flag){var i=h(t);a.pinchFlag&&a.onPinch(t,i);var n=a.move([0,0],t,i);if(n&&(n.deltaX||n.deltaY)){var s=a.options.drag;s&&s(u({},n,{inputEvent:t}))}}},this.onDragEnd=function(t){if(a.flag){a.pinchFlag&&a.onPinchEnd(t),a.flag=!1;var i=a.options.dragend,n=a.prevClients,s=a.startClients,e=a.pinchFlag?p(n,n,s,a.startPinchClients):f(n[0],n[0],s[0]);a.startClients=[],a.prevClients=[],i&&i(u({datas:a.datas,isDrag:a.isDrag,inputEvent:t},e))}},this.options=u({container:t,preventRightClick:!0,pinchThreshold:0,events:["touch","mouse"]},i);var n=this.options,s=n.container,e=n.events;this.isTouch=-1<e.indexOf("touch"),this.isMouse=-1<e.indexOf("mouse"),this.customDist=[0,0],this.isMouse&&(c(t,"mousedown",this.onDragStart),c(s,"mousemove",this.onDrag),c(s,"mouseup",this.onDragEnd)),this.isTouch&&(c(t,"touchstart",this.onDragStart),c(s,"touchmove",this.onDrag),c(s,"touchend",this.onDragEnd))}var i=t.prototype;return i.isDragging=function(){return this.isDrag},i.isPinching=function(){return this.isPinch},i.move=function(t,i,n){var s=t[0],e=t[1];void 0===n&&(n=this.prevClients);var a=this.customDist,h=this.prevClients,r=this.startClients,o=this.pinchFlag?p(n,h,r,this.startPinchClients):f(n[0],h[0],r[0]);a[0]+=s,a[1]+=e,o.deltaX+=s,o.deltaY+=e;var c=o.deltaX,l=o.deltaY;return o.distX+=a[0],o.distY+=a[1],this.movement+=Math.sqrt(c*c+l*l),this.prevClients=n,this.isDrag=!0,u({datas:this.datas},o,{inputEvent:i})},i.onPinchStart=function(t){var i,n,s=this.options,e=s.pinchstart,a=s.pinchThreshold;if(!(this.isDrag&&this.movement>a)){var h=g(t.changedTouches);if(this.pinchFlag=!0,(i=this.startClients).push.apply(i,h),(n=this.prevClients).push.apply(n,h),this.startDistance=l(this.prevClients),this.startPinchClients=this.prevClients.slice(),e){var r=this.prevClients,o=d(r),c=f(o,o,o);e(u({datas:this.datas,touches:v(r,r,r)},c,{inputEvent:t}))}}},i.onPinch=function(t,i){if(this.flag&&this.pinchFlag){this.isPinch=!0;var n=this.options.pinch;if(n){var s=this.prevClients,e=this.startClients,a=f(d(i),d(s),d(e)),h=l(i);n(u({datas:this.datas,touches:v(i,s,e),scale:h/this.startDistance,distance:h},a,{inputEvent:t}))}}},i.onPinchEnd=function(t){if(this.flag&&this.pinchFlag){var i=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var n=this.options.pinchend;if(n){var s=this.prevClients,e=this.startClients,a=f(d(s),d(s),d(e));n(u({datas:this.datas,isPinch:i,touches:v(s,s,e)},a,{inputEvent:t})),this.isPinch=!1,this.pinchFlag=!1}}},i.unset=function(){var t=this.el,i=this.options.container;this.isMouse&&(n(t,"mousedown",this.onDragStart),n(i,"mousemove",this.onDrag),n(i,"mouseup",this.onDragEnd)),this.isTouch&&(n(t,"touchstart",this.onDragStart),n(i,"touchmove",this.onDrag),n(i,"touchend",this.onDragEnd))},t}();return s.drag=function(t,i){return new s(t,i)},s});
//# sourceMappingURL=drag.min.js.map
