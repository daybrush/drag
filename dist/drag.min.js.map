{"version":3,"file":"drag.min.js","sources":["../src/Dragger.ts","../src/drag.ts"],"sourcesContent":["import { DragOptions } from \"./types\";\n\nfunction getPosition(e) {\n    return e.touches && e.touches.length ? e.touches[0] : e;\n}\n\nexport default class Dragger {\n    private flag = false;\n    private startX = 0;\n    private startY = 0;\n    private prevX = 0;\n    private prevY = 0;\n    private datas = {};\n    private options: DragOptions = {};\n    private isDrag = false;\n    private isMouse = false;\n    private isTouch = false;\n\n    constructor(private el: Element, options: DragOptions = {}) {\n        this.options = {\n            container: el,\n            preventRightClick: true,\n            events: [\"touch\", \"mouse\"],\n            ...options,\n        };\n\n        const { container, events } = this.options;\n\n        this.isTouch = events.indexOf(\"touch\") > -1;\n        this.isMouse = events.indexOf(\"mouse\") > -1;\n\n        if (this.isMouse) {\n            el.addEventListener(\"mousedown\", this.onDragStart);\n            container.addEventListener(\"mousemove\", this.onDrag);\n            container.addEventListener(\"mouseup\", this.onDragEnd);\n        }\n        if (this.isTouch) {\n            el.addEventListener(\"touchstart\", this.onDragStart);\n            container.addEventListener(\"touchmove\", this.onDrag);\n            container.addEventListener(\"touchend\", this.onDragEnd);\n        }\n    }\n    public isDragging() {\n        return this.isDrag;\n    }\n    public onDragStart = (e: any) => {\n        this.flag = true;\n        this.isDrag = false;\n        const { clientX, clientY } = getPosition(e);\n\n        this.startX = clientX;\n        this.startY = clientY;\n        this.prevX = clientX;\n        this.prevY = clientY;\n        this.datas = {};\n\n        const {\n            dragstart,\n            preventRightClick,\n        } = this.options;\n\n        if (\n            (preventRightClick && e.which === 3)\n            || (dragstart && dragstart({\n                datas: this.datas,\n                inputEvent: e,\n                clientX,\n                clientY,\n            })) === false) {\n            this.flag = false;\n        }\n        this.flag && e.preventDefault();\n    }\n    public onDrag = (e: any) => {\n        if (!this.flag) {\n            return;\n        }\n\n        const { clientX, clientY } = getPosition(e);\n        const deltaX = clientX - this.prevX;\n        const deltaY = clientY - this.prevY;\n\n        if (!deltaX && !deltaY) {\n            return;\n        }\n        this.isDrag = true;\n\n        const drag = this.options.drag;\n        drag && drag({\n            datas: this.datas,\n            clientX,\n            clientY,\n            deltaX,\n            deltaY,\n            distX: clientX - this.startX,\n            distY: clientY - this.startY,\n            inputEvent: e,\n        });\n\n        this.prevX = clientX;\n        this.prevY = clientY;\n    }\n    public onDragEnd = (e: any) => {\n        if (!this.flag) {\n            return;\n        }\n        this.flag = false;\n\n        const dragend = this.options.dragend;\n        dragend && dragend({\n            datas: this.datas,\n            isDrag: this.isDrag,\n            inputEvent: e,\n            clientX: this.prevX,\n            clientY: this.prevY,\n            distX: this.prevX - this.startX,\n            distY: this.prevY - this.startY,\n        });\n    }\n    public unset() {\n        const el = this.el;\n        const container = this.options.container!;\n\n        if (this.isMouse) {\n            el.removeEventListener(\"mousedown\", this.onDragStart);\n            container.removeEventListener(\"mousemove\", this.onDrag);\n            container.removeEventListener(\"mouseup\", this.onDragEnd);\n        }\n        if (this.isTouch) {\n            el.removeEventListener(\"touchstart\", this.onDragStart);\n            container.removeEventListener(\"touchmove\", this.onDrag);\n            container.removeEventListener(\"touchend\", this.onDragEnd);\n        }\n    }\n}\n","import Dragger from \"./Dragger\";\nimport { DragOptions } from \"./types\";\n\nexport default function setDrag(el: Element, options: DragOptions) {\n    return new Dragger(el, options);\n}\n"],"names":["getPosition","e","touches","length","el","options","_this","flag","isDrag","_a","clientX","clientY","startX","startY","prevX","prevY","datas","_b","dragstart","which","inputEvent","preventDefault","deltaX","deltaY","drag","distX","distY","dragend","container","preventRightClick","events","isTouch","indexOf","isMouse","this","addEventListener","onDragStart","onDrag","onDragEnd","removeEventListener","Dragger"],"mappings":";;;;;;;;qZAEA,SAASA,EAAYC,UACVA,EAAEC,SAAWD,EAAEC,QAAQC,OAASF,EAAEC,QAAQ,GAAKD,EAG1D,4BAYwBG,EAAaC,2BAAAA,cAAbD,aAXL,cACE,cACA,aACD,aACA,aACA,gBACe,gBACd,gBACC,gBACA,mBA6BG,SAACH,GAClBK,EAAKC,MAAO,EACZD,EAAKE,QAAS,MACRC,OAAEC,YAASC,YAEjBL,EAAKM,OAASF,EACdJ,EAAKO,OAASF,EACdL,EAAKQ,MAAQJ,EACbJ,EAAKS,MAAQJ,EACbL,EAAKU,MAAQ,OAEPC,YACFC,oCAKkC,IAAZjB,EAAEkB,QAMhB,KALJD,GAAaA,EAAU,CACvBF,MAAOV,EAAKU,MACZI,WAAYnB,EACZS,UACAC,gBAEJL,EAAKC,MAAO,GAEhBD,EAAKC,MAAQN,EAAEoB,8BAEH,SAACpB,MACRK,EAAKC,UAIJE,OAAEC,YAASC,YACXW,EAASZ,EAAUJ,EAAKQ,MACxBS,EAASZ,EAAUL,EAAKS,SAEzBO,GAAWC,GAGhBjB,EAAKE,QAAS,MAERgB,EAAOlB,EAAKD,QAAQmB,KAC1BA,GAAQA,EAAK,CACTR,MAAOV,EAAKU,MACZN,UACAC,UACAW,SACAC,SACAE,MAAOf,EAAUJ,EAAKM,OACtBc,MAAOf,EAAUL,EAAKO,OACtBO,WAAYnB,IAGhBK,EAAKQ,MAAQJ,EACbJ,EAAKS,MAAQJ,oBAEE,SAACV,MACXK,EAAKC,MAGVD,EAAKC,MAAO,MAENoB,EAAUrB,EAAKD,QAAQsB,QAC7BA,GAAWA,EAAQ,CACfX,MAAOV,EAAKU,MACZR,OAAQF,EAAKE,OACbY,WAAYnB,EACZS,QAASJ,EAAKQ,MACdH,QAASL,EAAKS,MACdU,MAAOnB,EAAKQ,MAAQR,EAAKM,OACzBc,MAAOpB,EAAKS,MAAQT,EAAKO,gBAjGxBR,WACDuB,UAAWxB,EACXyB,mBAAmB,EACnBC,OAAQ,CAAC,QAAS,UACfzB,OAGDI,eAAEmB,cAAWE,gBAEdC,SAAqC,EAA3BD,EAAOE,QAAQ,cACzBC,SAAqC,EAA3BH,EAAOE,QAAQ,SAE1BE,KAAKD,UACL7B,EAAG+B,iBAAiB,YAAaD,KAAKE,aACtCR,EAAUO,iBAAiB,YAAaD,KAAKG,QAC7CT,EAAUO,iBAAiB,UAAWD,KAAKI,YAE3CJ,KAAKH,UACL3B,EAAG+B,iBAAiB,aAAcD,KAAKE,aACvCR,EAAUO,iBAAiB,YAAaD,KAAKG,QAC7CT,EAAUO,iBAAiB,WAAYD,KAAKI,kDAGpD,kBACWJ,KAAK1B,gBA4EhB,eACUJ,EAAK8B,KAAK9B,GACVwB,EAAYM,KAAK7B,QAAQuB,UAE3BM,KAAKD,UACL7B,EAAGmC,oBAAoB,YAAaL,KAAKE,aACzCR,EAAUW,oBAAoB,YAAaL,KAAKG,QAChDT,EAAUW,oBAAoB,UAAWL,KAAKI,YAE9CJ,KAAKH,UACL3B,EAAGmC,oBAAoB,aAAcL,KAAKE,aAC1CR,EAAUW,oBAAoB,YAAaL,KAAKG,QAChDT,EAAUW,oBAAoB,WAAYL,KAAKI,kCChI3BlC,EAAaC,UAClC,IAAImC,EAAQpC,EAAIC"}