{"version":3,"file":"drag.esm.js","sources":["../src/Dragger.ts","../src/drag.ts"],"sourcesContent":["import { DragOptions } from \"./types\";\n\nfunction getPosition(e) {\n    return e.touches && e.touches.length ? e.touches[0] : e;\n}\n\nexport default class Dragger {\n    private flag = false;\n    private startX = 0;\n    private startY = 0;\n    private prevX = 0;\n    private prevY = 0;\n    private datas = {};\n    private options: DragOptions = {};\n    private isDrag = false;\n    private isMouse = false;\n    private isTouch = false;\n\n    constructor(private el: Element, options: DragOptions = {}) {\n        this.options = {\n            container: el,\n            preventRightClick: true,\n            events: [\"touch\", \"mouse\"],\n            ...options,\n        };\n\n        const { container, events } = this.options;\n\n        this.isTouch = events.indexOf(\"touch\") > -1;\n        this.isMouse = events.indexOf(\"mouse\") > -1;\n\n        if (this.isMouse) {\n            el.addEventListener(\"mousedown\", this.onDragStart);\n            container.addEventListener(\"mousemove\", this.onDrag);\n            container.addEventListener(\"mouseup\", this.onDragEnd);\n        }\n        if (this.isTouch) {\n            el.addEventListener(\"touchstart\", this.onDragStart);\n            container.addEventListener(\"touchmove\", this.onDrag);\n            container.addEventListener(\"touchend\", this.onDragEnd);\n        }\n    }\n    public isDragging() {\n        return this.isDrag;\n    }\n    public onDragStart = (e: any) => {\n        this.flag = true;\n        this.isDrag = false;\n        const { clientX, clientY } = getPosition(e);\n\n        this.startX = clientX;\n        this.startY = clientY;\n        this.prevX = clientX;\n        this.prevY = clientY;\n        this.datas = {};\n\n        const {\n            dragstart,\n            preventRightClick,\n        } = this.options;\n\n        if (\n            (preventRightClick && e.which === 3)\n            || (dragstart && dragstart({\n                datas: this.datas,\n                inputEvent: e,\n                clientX,\n                clientY,\n            })) === false) {\n            this.flag = false;\n        }\n        this.flag && e.preventDefault();\n    }\n    public onDrag = (e: any) => {\n        if (!this.flag) {\n            return;\n        }\n\n        const { clientX, clientY } = getPosition(e);\n        const deltaX = clientX - this.prevX;\n        const deltaY = clientY - this.prevY;\n\n        if (!deltaX && !deltaY) {\n            return;\n        }\n        this.isDrag = true;\n\n        const drag = this.options.drag;\n        drag && drag({\n            datas: this.datas,\n            clientX,\n            clientY,\n            deltaX,\n            deltaY,\n            distX: clientX - this.startX,\n            distY: clientY - this.startY,\n            inputEvent: e,\n        });\n\n        this.prevX = clientX;\n        this.prevY = clientY;\n    }\n    public onDragEnd = (e: any) => {\n        if (!this.flag) {\n            return;\n        }\n        this.flag = false;\n\n        const dragend = this.options.dragend;\n        dragend && dragend({\n            datas: this.datas,\n            isDrag: this.isDrag,\n            inputEvent: e,\n            clientX: this.prevX,\n            clientY: this.prevY,\n            distX: this.prevX - this.startX,\n            distY: this.prevY - this.startY,\n        });\n    }\n    public unset() {\n        const el = this.el;\n        const container = this.options.container!;\n\n        if (this.isMouse) {\n            el.removeEventListener(\"mousedown\", this.onDragStart);\n            container.removeEventListener(\"mousemove\", this.onDrag);\n            container.removeEventListener(\"mouseup\", this.onDragEnd);\n        }\n        if (this.isTouch) {\n            el.removeEventListener(\"touchstart\", this.onDragStart);\n            container.removeEventListener(\"touchmove\", this.onDrag);\n            container.removeEventListener(\"touchend\", this.onDragEnd);\n        }\n    }\n}\n","import Dragger from \"./Dragger\";\nimport { DragOptions } from \"./types\";\n\nexport default function setDrag(el: Element, options: DragOptions) {\n    return new Dragger(el, options);\n}\n"],"names":["getPosition","e","touches","length","el","options","_this","flag","isDrag","_a","clientX","clientY","startX","startY","prevX","prevY","datas","_b","dragstart","preventRightClick","which","inputEvent","preventDefault","deltaX","deltaY","drag","distX","distY","dragend","container","events","isTouch","indexOf","isMouse","addEventListener","onDragStart","onDrag","onDragEnd","removeEventListener","setDrag","Dragger"],"mappings":"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"}