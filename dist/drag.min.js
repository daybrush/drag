/*
Copyright (c) 2019 Daybrush
name: @daybrush/drag
license: MIT
author: Daybrush
repository: git+https://github.com/daybrush/drag.git
version: 0.8.2
*/
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t=t||self).Dragger={})}(this,function(t){"use strict";var c=function(){return(c=Object.assign||function(t){for(var n,i=1,s=arguments.length;i<s;i++)for(var e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)};function o(t,n,i){var s=g(t),e=g(n),a=g(i);return l(r(i[0],v(s,a)),r(i[0],v(e,a)),i[0])}function h(t){return t.touches?f(t.touches):[e(t)]}function l(t,n,i){var s=t.clientX,e=t.clientY;return{clientX:s,clientY:e,deltaX:s-n.clientX,deltaY:e-n.clientY,distX:s-i.clientX,distY:e-i.clientY}}function u(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function p(t,i,s){return t.map(function(t,n){return l(t,i[n],s[n])})}function f(t){for(var n=Math.min(t.length,2),i=[],s=0;s<n;++s)i.push(e(t[s]));return i}function e(t){return{clientX:t.clientX,clientY:t.clientY}}function g(t){return{clientX:(t[0].clientX+t[1].clientX)/2,clientY:(t[0].clientY+t[1].clientY)/2}}function r(t,n){return{clientX:t.clientX+n.clientX,clientY:t.clientY+n.clientY}}function v(t,n){return{clientX:t.clientX-n.clientX,clientY:t.clientY-n.clientY}}function a(t,n,i,s){t.addEventListener(n,i,s)}function i(t,n,i){t.removeEventListener(n,i)}var s=function(){function t(t,n){var r=this;void 0===n&&(n={}),this.el=t,this.options={},this.flag=!1,this.pinchFlag=!1,this.datas={},this.isDrag=!1,this.isPinch=!1,this.isMouse=!1,this.isTouch=!1,this.prevClients=[],this.startClients=[],this.onDragStart=function(t){if((r.flag||!1!==t.cancelable)&&(r.isDrag||!function(t){return t.touches&&2<=t.touches.length}(t)||r.pinchFlag||r.onPinchStart(t),!r.flag)){var n=r.startClients[0]?r.startClients:h(t);r.flag=!0,r.isDrag=!1,r.startClients=n,r.prevClients=n,r.datas={};var i=l(n[0],r.prevClients[0],r.startClients[0]),s=r.options,e=s.dragstart;(s.preventRightClick&&3===t.which||!1===(e&&e(c({datas:r.datas,inputEvent:t},i))))&&(r.flag=!1),r.flag&&t.preventDefault()}},this.onDrag=function(t){if(r.flag){var n=h(t);r.pinchFlag&&r.onPinch(t,n);var i=r.prevClients,s=r.startClients,e=r.pinchFlag?o(n,i,s):l(n[0],i[0],s[0]);if(e.deltaX||e.deltaY){r.isDrag=!0;var a=r.options.drag;a&&a(c({datas:r.datas},e,{inputEvent:t})),r.prevClients=n}}},this.onDragEnd=function(t){if(r.flag){r.pinchFlag&&r.onPinchEnd(t),r.flag=!1;var n=r.options.dragend,i=r.prevClients,s=r.startClients,e=r.pinchFlag?o(i,i,s):l(i[0],i[0],s[0]);r.startClients=[],r.prevClients=[],n&&n(c({datas:r.datas,isDrag:r.isDrag,inputEvent:t},e))}},this.options=c({container:t,preventRightClick:!0,events:["touch","mouse"]},n);var i=this.options,s=i.container,e=i.events;this.isTouch=-1<e.indexOf("touch"),this.isMouse=-1<e.indexOf("mouse"),this.isMouse&&(a(t,"mousedown",this.onDragStart),a(s,"mousemove",this.onDrag),a(s,"mouseup",this.onDragEnd)),this.isTouch&&(a(t,"touchstart",this.onDragStart),a(s,"touchmove",this.onDrag),a(s,"touchend",this.onDragEnd))}var n=t.prototype;return n.isDragging=function(){return this.isDrag},n.isPinching=function(){return this.isPinch},n.onPinchStart=function(t){var n,i;this.pinchFlag=!0;var s=this.options.pinchstart,e=f(t.changedTouches);if((n=this.startClients).push.apply(n,e),(i=this.prevClients).push.apply(i,e),s){var a=this.startClients,r=g(a),o=l(r,r,r);s(c({datas:this.datas,touches:p(a,a,a)},o,{inputEvent:t}))}},n.onPinch=function(t,n){if(this.flag&&this.pinchFlag){this.isPinch=!0;var i=this.options.pinch;if(i){var s=this.prevClients,e=this.startClients,a=l(g(n),g(s),g(e)),r=u(n),o=u(e);i(c({datas:this.datas,touches:p(n,s,e),scale:r/o,distance:r},a,{inputEvent:t}))}}},n.onPinchEnd=function(t){if(this.flag&&this.pinchFlag){var n=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var i=this.options.pinchend;if(i){var s=this.prevClients,e=this.startClients,a=l(g(s),g(s),g(e));i(c({datas:this.datas,isPinch:n,touches:p(s,s,e)},a,{inputEvent:t})),this.isPinch=!1,this.pinchFlag=!1}}},n.unset=function(){var t=this.el,n=this.options.container;this.isMouse&&(i(t,"mousedown",this.onDragStart),i(n,"mousemove",this.onDrag),i(n,"mouseup",this.onDragEnd)),this.isTouch&&(i(t,"touchstart",this.onDragStart),i(n,"touchmove",this.onDrag),i(n,"touchend",this.onDragEnd))},t}();t.default=s,t.drag=function(t,n){return new s(t,n)}});
//# sourceMappingURL=drag.min.js.map
