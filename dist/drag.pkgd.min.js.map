{"version":3,"file":"drag.pkgd.min.js","sources":["../src/drag.ts"],"sourcesContent":["import { DragOptions } from \"./types\";\n\nexport default function setDrag(el: Element, options: DragOptions) {\n    let flag = false;\n    let startX = 0;\n    let startY = 0;\n    let prevX = 0;\n    let prevY = 0;\n    let datas = {};\n    let isDrag = false;\n\n    const { container = el, dragstart, drag, dragend, events = [\"touch\", \"mouse\"] } = options;\n    const isTouch = events.indexOf(\"touch\") > -1;\n    const isMouse = events.indexOf(\"mouse\") > -1;\n\n    function getPosition(e) {\n        return e.touches && e.touches.length ? e.touches[0] : e;\n    }\n\n    function onDragStart(e) {\n        flag = true;\n        isDrag = false;\n        const { clientX, clientY } = getPosition(e);\n\n        startX = clientX;\n        startY = clientY;\n        prevX = clientX;\n        prevY = clientY;\n        datas = {};\n        ((dragstart && dragstart({ datas, inputEvent: e, clientX, clientY })) === false) && (flag = false);\n\n        flag && e.preventDefault();\n    }\n    function onDrag(e) {\n        if (!flag) {\n            return;\n        }\n\n        const { clientX, clientY } = getPosition(e);\n        const deltaX = clientX - prevX;\n        const deltaY = clientY - prevY;\n\n        if (!deltaX && !deltaY) {\n            return;\n        }\n        isDrag = true;\n        drag && drag({\n            datas,\n            clientX,\n            clientY,\n            deltaX,\n            deltaY,\n            distX: clientX - startX,\n            distY: clientY - startY,\n            inputEvent: e,\n        });\n\n        prevX = clientX;\n        prevY = clientY;\n    }\n    function onDragEnd(e) {\n        if (!flag) {\n            return;\n        }\n        flag = false;\n\n        dragend && dragend({\n            datas,\n            isDrag,\n            inputEvent: e,\n            clientX: prevX,\n            clientY: prevY,\n            distX: prevX - startX,\n            distY: prevY - startY,\n        });\n    }\n\n    if (isMouse) {\n        el.addEventListener(\"mousedown\", onDragStart);\n        container.addEventListener(\"mousemove\", onDrag);\n        container.addEventListener(\"mouseup\", onDragEnd);\n    }\n    if (isTouch) {\n        el.addEventListener(\"touchstart\", onDragStart);\n        container.addEventListener(\"touchmove\", onDrag);\n        container.addEventListener(\"touchend\", onDragEnd);\n    }\n\n    return {\n        unset() {\n            if (isMouse) {\n                el.removeEventListener(\"mousedown\", onDragStart);\n                container.removeEventListener(\"mousemove\", onDrag);\n                container.removeEventListener(\"mouseup\", onDragEnd);\n            }\n            if (isTouch) {\n                el.removeEventListener(\"touchstart\", onDragStart);\n                container.removeEventListener(\"touchmove\", onDrag);\n                container.removeEventListener(\"touchend\", onDragEnd);\n            }\n        },\n    };\n}\n"],"names":["el","options","flag","startX","startY","prevX","prevY","datas","isDrag","_a","container","dragstart","drag","dragend","_b","events","isTouch","indexOf","isMouse","getPosition","e","touches","length","onDragStart","clientX","clientY","inputEvent","preventDefault","onDrag","deltaX","deltaY","distX","distY","onDragEnd","addEventListener","unset","removeEventListener"],"mappings":";;;;;;;;kNAEgCA,EAAaC,OACrCC,GAAO,EACPC,EAAS,EACTC,EAAS,EACTC,EAAQ,EACRC,EAAQ,EACRC,EAAQ,GACRC,GAAS,EAELC,cAAAC,iBAAgBC,cAAWC,SAAMC,YAASC,WAAAC,iCAC5CC,GAAqC,EAA3BD,EAAOE,QAAQ,SACzBC,GAAqC,EAA3BH,EAAOE,QAAQ,kBAEtBE,EAAYC,UACVA,EAAEC,SAAWD,EAAEC,QAAQC,OAASF,EAAEC,QAAQ,GAAKD,WAGjDG,EAAYH,GAEjBZ,IADAN,GAAO,OAEDO,OAAEe,YAASC,YAIjBpB,EAFAF,EAASqB,EAGTlB,EAFAF,EAASqB,IAGTlB,EAAQ,OACNI,GAAaA,EAAU,CAAEJ,QAAOmB,WAAYN,EAAGI,UAASC,eAA2BvB,GAAO,GAE5FA,GAAQkB,EAAEO,0BAELC,EAAOR,MACPlB,OAICO,OAAEe,YAASC,YACXI,EAASL,EAAUnB,EACnByB,EAASL,EAAUnB,GAEpBuB,GAAWC,KAGhBtB,GAAS,EACTI,GAAQA,EAAK,CACTL,QACAiB,UACAC,UACAI,SACAC,SACAC,MAAOP,EAAUrB,EACjB6B,MAAOP,EAAUrB,EACjBsB,WAAYN,IAGhBf,EAAQmB,EACRlB,EAAQmB,aAEHQ,EAAUb,GACVlB,IAGLA,GAAO,EAEPW,GAAWA,EAAQ,CACfN,QACAC,SACAkB,WAAYN,EACZI,QAASnB,EACToB,QAASnB,EACTyB,MAAO1B,EAAQF,EACf6B,MAAO1B,EAAQF,YAInBc,IACAlB,EAAGkC,iBAAiB,YAAaX,GACjCb,EAAUwB,iBAAiB,YAAaN,GACxClB,EAAUwB,iBAAiB,UAAWD,IAEtCjB,IACAhB,EAAGkC,iBAAiB,aAAcX,GAClCb,EAAUwB,iBAAiB,YAAaN,GACxClB,EAAUwB,iBAAiB,WAAYD,IAGpC,CACHE,iBACQjB,IACAlB,EAAGoC,oBAAoB,YAAab,GACpCb,EAAU0B,oBAAoB,YAAaR,GAC3ClB,EAAU0B,oBAAoB,UAAWH,IAEzCjB,IACAhB,EAAGoC,oBAAoB,aAAcb,GACrCb,EAAU0B,oBAAoB,YAAaR,GAC3ClB,EAAU0B,oBAAoB,WAAYH"}